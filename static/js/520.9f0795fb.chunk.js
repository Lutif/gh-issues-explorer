"use strict";(self.webpackChunkgh_issues_frontend=self.webpackChunkgh_issues_frontend||[]).push([[520],{3375:function(n,e,r){r.d(e,{BJ:function(){return m},AH:function(){return l},vh:function(){return c},zo:function(){return d}});var t,o,s,a,i=r(168),u=r(4242),c=(0,u.ZP)(t||(t=(0,i.Z)(["\n  query getRepoIssues(\n    $repositoryOwner: String!\n    $repositoryName: String!\n    $issueState: IssueState!\n    $cursor: String\n    $pageSize: Int = 10\n  ) {\n    repository(name: $repositoryName, owner: $repositoryOwner) {\n      issues(last: $pageSize, states: [$issueState], before: $cursor) {\n        edges {\n          node {\n            id\n            number\n            state\n            title\n            url\n            bodyHTML\n            closed\n            createdAt\n            closedAt\n            author {\n              login\n              avatarUrl\n              url\n            }\n            comments(last: $pageSize) {\n              totalCount\n              edges {\n                node {\n                  bodyHTML\n                  createdAt\n                  author {\n                    login\n                    avatarUrl\n                    url\n                  }\n                }\n              }\n            }\n          }\n        }\n        pageInfo {\n          endCursor\n          hasNextPage\n          startCursor\n        }\n      }\n    }\n  }\n"]))),l=(0,u.ZP)(o||(o=(0,i.Z)(["\n  query FindIssueID(\n    $repositoryOwner: String!\n    $repositoryName: String!\n    $issueNumber: Int!\n    $pageSize: Int = 10\n  ) {\n    repository(name: $repositoryName, owner: $repositoryOwner) {\n      issue(number: $issueNumber) {\n        id\n        number\n        state\n        title\n        url\n        bodyHTML\n        closed\n        createdAt\n        closedAt\n        author {\n          login\n          avatarUrl\n          url\n        }\n        comments(first: $pageSize) {\n          totalCount\n          pageInfo {\n            endCursor\n            hasNextPage\n            startCursor\n          }\n          edges {\n            node {\n              bodyHTML\n              createdAt\n              author {\n                login\n                avatarUrl\n                url\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n"]))),d=(0,u.ZP)(s||(s=(0,i.Z)(["\n  query searchIssue($text: String!, $cursor: String, $pageSize: Int = 10) {\n    search(first: $pageSize, query: $text, type: ISSUE, after: $cursor) {\n      pageInfo {\n        endCursor\n        hasNextPage\n        startCursor\n      }\n      nodes {\n        ... on Issue {\n          id\n          number\n          state\n          title\n          url\n          bodyHTML\n          closed\n          createdAt\n          closedAt\n          author {\n            login\n            avatarUrl\n            url\n          }\n        }\n      }\n    }\n  }\n"]))),m=(0,u.ZP)(a||(a=(0,i.Z)(["\n  query fetchComments(\n    $repositoryOwner: String!\n    $repositoryName: String!\n    $issueNumber: Int!\n    $cursor: String\n    $pageSize: Int = 10\n  ) {\n    repository(name: $repositoryName, owner: $repositoryOwner) {\n      issue(number: $issueNumber) {\n        id\n        comments(first: $pageSize, after: $cursor) {\n          edges {\n            node {\n              id\n              bodyHTML\n              author {\n                login\n              }\n            }\n          }\n          pageInfo {\n            endCursor\n            hasNextPage\n            startCursor\n          }\n        }\n      }\n    }\n  }\n"])))},6520:function(n,e,r){r.r(e),r.d(e,{IssueDetailsPage:function(){return h}});var t,o,s=r(4495),a=(r(2791),r(2426)),i=r.n(a),u=r(168),c=r(7691),l=c.ZP.div(t||(t=(0,u.Z)(["\n  border: 2px solid #e5e5e5;\n  border-radius: 5px;\n  padding: 5px 10px;\n  margin-bottom: 10px;\n  .content {\n    max-height: 30vh;\n    overflow-y: auto;\n    margin: 0px;\n    padding: 0px;\n    font-size: 14px;\n  }\n  .sub-text {\n    font-size: 14px;\n    color: grey;\n  }\n"]))),d=r(184),m=function(n){var e=n.comment.node,r=e.bodyHTML,t=e.author,o=(t=void 0===t?{}:t).login,s=e.createdAt,a="Commented ".concat(i()(s).fromNow()," by ").concat(o);return(0,d.jsxs)(l,{children:[(0,d.jsx)("div",{className:"content",dangerouslySetInnerHTML:{__html:r}}),(0,d.jsx)("div",{className:"sub-text",children:a})]})},p=r(5310),g=c.ZP.div(o||(o=(0,u.Z)(["\n  margin: 20px 10px;\n  .title {\n    font-size: 20px;\n    font-weight: bold;\n    color: #333;\n    border: 2px solid #e5e5e5;\n    border-radius: 5px;\n    padding: 5px 10px;\n    display: flex;\n    justify-content: space-between;\n    .author {\n      font-size: 18px;\n      color: grey;\n      margin-right: 10px;\n    }\n  }\n  .body {\n    margin-top: 10px;\n    font-size: 16px;\n    color: #222;\n    border: 2px solid #e5e5e5;\n    border-radius: 5px;\n    padding: 5px 10px;\n    max-height: 80vh;\n    overflow-y: auto;\n  }\n  .comments {\n    margin: 15px 0px 0px 20px;\n  }\n  .fetch-more {\n    margin-top: 10px;\n    display: flex;\n    justify-content: center;\n  }\n"]))),f=r(7205),h=function(){var n=(null===s.T||void 0===s.T?void 0:(0,s.T)())||{},e=n.issue,r=n.comments,t=n.isLoading,o=n.hasMoreComments,a=n.loadingComments,i=n.fetchMoreComments,u=e||{},c=u.title,l=u.bodyHTML,h=(u.author||{}).login;return(0,d.jsxs)(g,{children:[(0,d.jsx)(p.m9,{if:t,children:(0,d.jsx)(p.gb,{})}),(0,d.jsx)(p.m9,{if:!t,children:(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"title",children:[c," ",(0,d.jsxs)("span",{className:"author",children:["Created by ",h]})]}),(0,d.jsx)("div",{className:"body",dangerouslySetInnerHTML:{__html:l}}),(0,d.jsx)("div",{className:"comments",children:null===r||void 0===r?void 0:r.map((function(n,e){return(0,d.jsx)(m,{comment:n},e)}))}),(0,d.jsx)("div",{className:"fetch-more",children:(0,d.jsx)(f.Z,{variant:"outlined",color:"info",size:"small",disabled:!o||a,onClick:i,children:"".concat(a||t?"Loading..":"Fetch more comments")})})]})})]})}},4495:function(n,e,r){r.d(e,{T:function(){return p}});var t=r(2982),o=r(885),s=r(6555),a=r(9271),i=r(9226),u=r(6586),c=r(3375),l=r(2791),d=r(5370),m=r.n(d),p=function(){var n=(0,a.TH)().pathname,e=(0,l.useState)(null),r=(0,o.Z)(e,2),d=r[0],p=r[1],g=(0,l.useState)([]),f=(0,o.Z)(g,2),h=f[0],x=f[1],y=(0,l.useState)(),b=(0,o.Z)(y,2),v=b[0],S=b[1],C=n.split("/").slice(1),I=(0,o.Z)(C,4),Z=I[0],$=I[1],N=(I[2],I[3]),P=(0,i.a)(c.AH,{variables:{repositoryName:$,repositoryOwner:Z,issueNumber:parseInt(N),pageSize:s.IV},onCompleted:function(n){p(n.repository.issue);var e=n.repository.issue.comments.edges;e&&x((function(n){return[].concat((0,t.Z)(n),(0,t.Z)(e))}));var r=n.repository.issue.comments.pageInfo.endCursor;S(r)},onError:function(n){m().toast({html:n.message})}}),z=P.loading,w=P.error,j=(0,u.t)(c.BJ,{onCompleted:function(n){var e=n.repository.issue.comments.edges;x((function(n){return[].concat((0,t.Z)(n),(0,t.Z)(e))}));var r=n.repository.issue.comments.pageInfo.endCursor;S(r)},onError:function(n){m().toast({html:n.message})}}),T=(0,o.Z)(j,2),L=T[0],O=T[1].loading,M=(0,l.useCallback)((function(){L({variables:{repositoryName:$,repositoryOwner:Z,issueNumber:parseInt(N),cursor:v,pageSize:s.IV}})}),[v,L,N,Z,$]);return{issue:d,hasMoreComments:!!v&&h.length>=s.IV,comments:h,isLoading:z,isError:!!w,fetchMoreComments:M,loadingComments:O}}},6555:function(n,e,r){var t;r.d(e,{IV:function(){return g.I},Wi:function(){return p}}),function(n){n.OPEN="OPEN",n.CLOSE="CLOSE"}(t||(t={}));var o=r(2982),s=r(885),a=r(6586),i=r(9226),u=r(2791),c=r(3375),l=r(9271),d=r(5370),m=r.n(d),p=function(){var n=(0,u.useState)([]),e=(0,s.Z)(n,2),r=e[0],t=e[1],d=(0,u.useState)([]),p=(0,s.Z)(d,2),f=p[0],h=p[1],x=(0,u.useState)(!1),y=(0,s.Z)(x,2),b=y[0],v=y[1],S=(0,u.useState)(null),C=(0,s.Z)(S,2),I=C[0],Z=C[1],$=(0,u.useState)(null),N=(0,s.Z)($,2),P=N[0],z=N[1],w=(0,u.useState)(0),j=(0,s.Z)(w,2),T=j[0],L=j[1],O=(0,u.useState)(""),M=(0,s.Z)(O,2),H=M[0],k=M[1],E=(0,l.TH)().pathname.split("/").slice(1,3),A=(0,s.Z)(E,2),_=A[0],U=A[1],q=(0,u.useCallback)((function(){L((function(n){return n+1}))}),[]),V=(0,u.useCallback)((function(){L(0)}),[]),F=(0,u.useCallback)((function(){L((function(n){return n-1}))}),[]),B=(0,a.t)(c.zo,{onCompleted:function(n){var e=n.search.nodes;e.length&&q();var r=[].concat((0,o.Z)(f),(0,o.Z)(e));h(r),z(n.search.pageInfo.endCursor)},onError:function(n){m().toast({html:n.message})},fetchPolicy:"network-only"}),D=(0,s.Z)(B,2),J=D[0],R=D[1],W=R.error,G=R.loading,K=(0,i.a)(c.vh,{variables:{repositoryOwner:_,repositoryName:U,pageSize:g.I,issueState:"OPEN"},fetchPolicy:"cache-first",onCompleted:function(n){var e=n.repository.issues.edges.map((function(n){return n.node}));e.reverse(),e.length&&q(),t((function(n){return[].concat((0,o.Z)(n),(0,o.Z)(e))})),Z(n.repository.issues.pageInfo.startCursor)},onError:function(n){m().toast({html:n.message})}}),Q=K.error,X=K.loading,Y=K.refetch,nn=(0,u.useCallback)((function(n){var e=n.isOpen,r=n.isNextPage;if(v(!!H),H){var t="repo:".concat(_,"/").concat(U," type:issue ").concat(H," state:").concat(e?"open":"closed");r||(V(),z(null),h([])),J({variables:{text:t,pageSize:g.I,cursor:r&&P}})}}),[_,U,V,J,P,H]),en=(0,u.useCallback)((function(n){nn({isNextPage:!0,isOpen:n})}),[nn]),rn=(0,u.useCallback)((function(n){b&&G||X&&!b||(H?f.length>T*g.I?q():en(n):r.length>T*g.I?q():Y({cursor:I}))}),[T,en,q,b,X,I,Y,r.length,f.length,H,G]);(0,u.useEffect)((function(){!H&&v(!1)}),[H]);var tn=!(!W&&!Q),on=X||G,sn=((T||1)-1)*g.I,an=sn+g.I;return{search:nn,data:(b?f:r).slice(sn,an),currentPage:T,hasMore:H?!!P:!!I,isError:tn,isLoading:on,gotoNextPage:rn,gotoPrevPage:F,setSearchText:k}},g=(r(4495),r(6591))}}]);
//# sourceMappingURL=520.9f0795fb.chunk.js.map